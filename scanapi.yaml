endpoints:
  - name: brasil_api
    path: https://brasilapi.com.br/api/
    requests:
      - name: list_banks_br
        path: /banks/v1
        method: get
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
          - name: response_body_has_content
            assert: ${{ response.json() != None }}
        vars:
          first_bank: ${{ response.json()[0]['code'] }}

      - name: list_one_bank_br
        path: /banks/v1/${first_bank}
        method: get
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
          - name: response_body_has_content
            assert: ${{ response.json() != None }}

      - name: get_bank_generate_404_error
        path: /banks/v1/INVALIDBANK
        method: get
        tests:
          - name: status_code_is_404
            assert: ${{ response.status_code == 404 }}
          - name: response_body_is_not_found
            assert: ${{ response.json()['type'] == 'BANK_CODE_NOT_FOUND' }}

      - name: list_feriados_br
        path: /feriados/v1/2021
        method: get
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
          - name: response_body_has_content
            assert: ${{ response.json() != None }}

      - name: get_feriados_generate_404_error
        path: /feriados/v1/1899
        method: get
        tests:
          - name: status_code_is_404
            assert: ${{ response.status_code == 404 }}
          - name: response_body_is_not_found
            assert: ${{ response.json()['type'] == 'feriados_range_error' }}

      - name: list_ufs_br
        path: /ibge/uf/v1
        method: get
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
          - name: response_body_has_content
            assert: ${{ response.json() != None }}
          - name: count_ufs_is_28
            assert: ${{ len(response.json()) == 27 }}
        vars:
          first_uf: ${{ response.json()[0]['sigla'] }}

      - name: list_one_uf_br
        path: /ibge/uf/v1/${first_uf}
        method: get
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
          - name: response_body_has_content
            assert: ${{ response.json() != None }}

      - name: get_uf_generate_404_error
        path: /ibge/uf/v1/INVALIDUF
        method: get
        tests:
          - name: status_code_is_404
            assert: ${{ response.status_code == 404 }}
          - name: response_body_is_not_found
            assert: ${{ response.json()['type'] == 'not_found' }}

      - name: list_uf_by_ddd_46
        path: /ddd/v1/46
        method: get
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
          - name: response_body_has_content
            assert: ${{ response.json() != None }}
          - name: response_body_is_valid
            assert: ${{ response.json()['state'] == 'PR' }}

      - name: get_ddd_generate_404_error
        path: /ddd/v1/00
        method: get
        tests:
          - name: status_code_is_404
            assert: ${{ response.status_code == 404 }}
          - name: response_body_is_not_found
            assert: ${{ response.json()['type'] == 'ddd_error' }}

      - name: list_cep
        path: /cep/v1/88034132
        method: get
        tests:
          - name: status_code_is_200
            assert: ${{ response.status_code == 200 }}
          - name: response_body_has_content
            assert: ${{ response.json() != None }}
          - name: response_body_is_valid
            assert: ${{ response.json()['state'] == 'SC' }}

      - name: get_cep_generate_404_error
        path: /cep/v1/00000000
        method: get
        tests:
          - name: status_code_is_404
            assert: ${{ response.status_code == 404 }}
          - name: response_body_is_not_found
            assert: ${{ response.json()['type'] == 'service_error' }}
